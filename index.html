<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>á€…á€­á€á€ºá€€á€¯á€‘á€¯á€¶á€¸á€™á€¾á€á€ºá€á€™á€ºá€¸ (Pro)</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Pyidaungsu:wght@400;700&display=swap" rel="stylesheet">
    <!-- Settings icon á€¡á€á€½á€€á€º Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    
    <style>
        :root {
            --primary-color: #1e40af; /* Indigo 700 */
            --primary-hover: #1d4ed8; /* Indigo 600 */
            --secondary-color: #6b7280; /* Gray 500 */
            --success-color: #10b981; /* Emerald 500 */
            --error-color: #ef4444; /* Red 500 */
            --background-color: #f8f9fa; /* Light Gray */
            --card-background: #ffffff; /* White */
            --text-primary: #1f2937; /* Gray 900 */
            --border-color: #dee2e6; /* Bootstrap default border */
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        body {
            font-family: 'Pyidaungsu', sans-serif;
            background-color: var(--background-color);
            color: var(--text-primary);
        }
        .card {
            box-shadow: var(--shadow-lg);
            border: none;
            animation: cardFadeIn 0.6s ease-out forwards;
            opacity: 0;
            transform: translateY(20px);
        }
        @keyframes cardFadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .btn {
            font-weight: 600;
            border-radius: 0.5rem;
            transition: all 0.25s ease-in-out;
            box-shadow: var(--shadow-md);
        }
        .btn:hover:not(:disabled) {
            transform: translateY(-3px) scale(1.03);
            box-shadow: var(--shadow-lg);
        }
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        .btn-primary:hover {
            background-color: var(--primary-hover);
            border-color: var(--primary-hover);
        }
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgb(30 64 175 / 25%);
        }
        .loading-spinner {
            display: inline-block;
            width: 1rem;
            height: 1rem;
            border: 2px solid transparent;
            border-top-color: currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 0.5rem;
        }
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
        .analysis-section {
            background-color: #f0fff4; /* á€¡á€…á€­á€™á€ºá€¸á€–á€»á€±á€¬á€· */
            border: 1px solid #a7e0b4; /* á€•á€­á€¯á€”á€€á€ºá€á€±á€¬á€¡á€…á€­á€™á€ºá€¸á€–á€»á€±á€¬á€· */
            color: var(--text-primary);
        }
        .hidden {
            display: none !important;
        }
        .history-item:hover {
            background-color: #f1f5f9; /* á€¡á€•á€¼á€¬-á€™á€®á€¸á€á€­á€¯á€¸á€–á€»á€±á€¬á€· */
            cursor: pointer;
        }
        .whitespace-pre-wrap {
            white-space: pre-wrap;
        }
        /* Chat UI Styles */
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 60vh; /* Adjust as needed */
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            background-color: var(--card-background);
            overflow: hidden;
        }
        .chat-history {
            flex-grow: 1;
            padding: 1rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        .chat-message {
            max-width: 80%;
            padding: 0.6rem 1rem;
            border-radius: 1rem;
        }
        .chat-message.user {
            align-self: flex-end;
            background-color: var(--primary-color);
            color: white;
            border-bottom-right-radius: 0.2rem;
        }
        .chat-message.ai {
            align-self: flex-start;
            background-color: #e2e8f0; /* Light gray for AI */
            color: var(--text-primary);
            border-bottom-left-radius: 0.2rem;
        }
        .chat-input-area {
            display: flex;
            padding: 1rem;
            border-top: 1px solid var(--border-color);
            gap: 0.5rem;
        }
        .chat-input {
            flex-grow: 1;
            border-radius: 0.5rem;
        }
    </style>
</head>
<body class="d-flex align-items-start justify-content-center py-4">
    <div class="container" style="max-width: 768px;">
        <div class="card p-3 p-md-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1 class="display-5 fw-bold text-center flex-grow-1" style="color: var(--primary-color);">á€…á€­á€á€ºá€€á€¯á€‘á€¯á€¶á€¸á€™á€¾á€á€ºá€á€™á€ºá€¸</h1>
                <button id="settingsBtn" class="btn btn-outline-secondary border-0 fs-4" title="á€á€»á€­á€”á€ºá€Šá€¾á€­á€™á€¾á€¯á€™á€»á€¬á€¸"><i class="bi bi-gear-fill"></i></button>
            </div>
            
            <div id="app-content" role="main">
                <!-- á€€á€­á€¯á€šá€ºá€›á€±á€¸á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€€á€¬á€€á€½á€šá€ºá€™á€¾á€¯áŠ á€…á€Šá€ºá€¸á€™á€»á€‰á€ºá€¸á€”á€¾á€„á€·á€º á€á€á€ºá€™á€¾á€á€ºá€á€»á€€á€ºá€™á€»á€¬á€¸ á€€á€á€¹á€á€™á€»á€¬á€¸ -->
                <div id="privacySection" class="section hidden text-center">
                    <h2 class="h3">á€€á€­á€¯á€šá€ºá€›á€±á€¸á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€€á€¬á€€á€½á€šá€ºá€™á€¾á€¯</h2>
                    <p class="mt-3">á€á€„á€·á€ºá€™á€¾á€á€ºá€á€™á€ºá€¸á€™á€»á€¬á€¸á€€á€­á€¯ á€á€„á€·á€º Browser á€á€½á€„á€ºá€á€¬ á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€•á€«á€á€Šá€ºá‹</p>
                    <button id="agreePrivacyBtn" class="btn btn-primary mt-3">á€á€˜á€±á€¬á€á€°á€á€Šá€º</button>
                </div>
                <div id="termsSection" class="section hidden text-center">
                    <h2 class="h3">á€…á€Šá€ºá€¸á€™á€»á€‰á€ºá€¸á€”á€¾á€„á€·á€º á€á€á€ºá€™á€¾á€á€ºá€á€»á€€á€ºá€™á€»á€¬á€¸</h2>
                    <p class="mt-3">á€™á€¾á€á€ºá€á€™á€ºá€¸á€™á€»á€¬á€¸ á€•á€»á€±á€¬á€€á€ºá€†á€¯á€¶á€¸á€á€¼á€„á€ºá€¸á€¡á€á€½á€€á€º á€á€¬á€á€”á€ºá€™á€šá€°á€•á€«á‹</p>
                    <button id="agreeTermsBtn" class="btn btn-primary mt-3">á€á€˜á€±á€¬á€á€°á€á€Šá€º</button>
                </div>

                <!-- á€á€»á€­á€”á€ºá€Šá€¾á€­á€™á€¾á€¯á€™á€»á€¬á€¸ á€€á€á€¹á€ -->
                <div id="settingsSection" class="section hidden">
                    <h2 class="h3 fw-bold text-center mb-4">á€á€»á€­á€”á€ºá€Šá€¾á€­á€™á€¾á€¯á€™á€»á€¬á€¸</h2>
                    <div class="mb-3">
                        <label for="userNameInput" class="form-label">á€á€„á€ºáá€¡á€™á€Šá€º:</label>
                        <input type="text" id="userNameInput" class="form-control" placeholder="á€á€„á€·á€ºá€¡á€™á€Šá€ºá€€á€­á€¯á€‘á€Šá€·á€ºá€•á€«">
                    </div>
                    <div class="mb-4">
                        <label for="apiKeyInput" class="form-label">Gemini API Key:</label>
                        <input type="password" id="apiKeyInput" class="form-control" placeholder="á€á€„á€ºá API Key á€€á€­á€¯á€‘á€Šá€·á€ºá€•á€«">
                    </div>
                    <div class="d-grid gap-2 mb-4">
                        <button id="saveSettingsBtn" class="btn btn-primary">á€á€­á€™á€ºá€¸á€™á€Šá€º</button>
                    </div>
                    <hr>
                    <h4 class="h5 mt-4">á€¡á€›á€”á€ºá€á€­á€™á€ºá€¸á€á€¼á€„á€ºá€¸á€”á€¾á€„á€·á€º á€•á€¼á€”á€ºá€œá€Šá€ºá€›á€šá€°á€á€¼á€„á€ºá€¸</h4>
                    <p class="text-muted small">á€á€„á€ºá API Key á€”á€¾á€„á€·á€º á€¡á€™á€Šá€ºá€€á€­á€¯ file á€á€…á€ºá€á€¯á€¡á€”á€±á€–á€¼á€„á€·á€º á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€”á€­á€¯á€„á€ºáŠ á€•á€¼á€”á€ºá€œá€Šá€ºá€‘á€Šá€·á€ºá€á€½á€„á€ºá€¸á€”á€­á€¯á€„á€ºá€á€Šá€ºá‹</p>
                    <div class="d-flex gap-2">
                        <button id="exportSettingsBtn" class="btn btn-outline-success w-100">á€á€»á€­á€”á€ºá€Šá€¾á€­á€™á€¾á€¯á€™á€»á€¬á€¸ á€‘á€¯á€á€ºá€šá€°á€™á€Šá€º</button>
                        <button id="importSettingsBtn" class="btn btn-outline-info w-100">á€á€»á€­á€”á€ºá€Šá€¾á€­á€™á€¾á€¯á€™á€»á€¬á€¸ á€‘á€Šá€·á€ºá€á€½á€„á€ºá€¸á€™á€Šá€º</button>
                        <input type="file" id="importFileInput" class="hidden" accept=".json">
                    </div>
                </div>

                <!-- á€•á€„á€ºá€™á€™á€¾á€á€ºá€á€™á€ºá€¸ á€€á€á€¹á€ -->
                <div id="journalSection" class="section hidden">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="journalDate" class="form-label fw-bold">á€›á€€á€ºá€…á€½á€²:</label>
                            <input type="date" id="journalDate" class="form-control" required>
                        </div>
                        <div class="col-md-6">
                            <label for="journalMood" class="form-label fw-bold">á€œá€€á€ºá€›á€¾á€­á€…á€­á€á€ºá€á€¶á€…á€¬á€¸á€™á€¾á€¯:</label>
                            <select id="journalMood" class="form-select" required>
                                <option value="" selected disabled>á€…á€­á€á€ºá€á€¶á€…á€¬á€¸á€™á€¾á€¯ á€›á€½á€±á€¸á€•á€«</option>
                                <option value="á€•á€»á€±á€¬á€ºá€›á€½á€¾á€„á€º">á€•á€»á€±á€¬á€ºá€›á€½á€¾á€„á€º ğŸ˜Š</option>
                                <option value="á€á€™á€ºá€¸á€”á€Šá€ºá€¸">á€á€™á€ºá€¸á€”á€Šá€ºá€¸ ğŸ˜¢</option>
                                <option value="á€…á€­á€á€ºá€á€­á€¯">á€…á€­á€á€ºá€á€­á€¯ ğŸ˜ </option>
                                <option value="á€…á€­á€á€ºá€œá€¾á€¯á€•á€ºá€›á€¾á€¬á€¸">á€…á€­á€á€ºá€œá€¾á€¯á€•á€ºá€›á€¾á€¬á€¸ ğŸ¤©</option>
                                <option value="á€„á€¼á€­á€™á€ºá€á€€á€º">á€„á€¼á€­á€™á€ºá€á€€á€º ğŸ˜Œ</option>
                                <option value="á€•á€„á€ºá€•á€”á€ºá€¸">á€•á€„á€ºá€•á€”á€ºá€¸ ğŸ˜´</option>
                                <option value="á€…á€­á€á€ºá€›á€¾á€¯á€•á€º">á€…á€­á€á€ºá€›á€¾á€¯á€•á€º ğŸ˜•</option>
                                <option value="á€€á€»á€±á€”á€•á€º">á€€á€»á€±á€”á€•á€º ğŸ‘</option>
                            </select>
                        </div>
                    </div>
                    <div class="mt-4 text-center">
                        <h3 class="h4 mb-3 fw-bold">á€˜á€šá€ºá€œá€­á€¯á€†á€½á€±á€¸á€”á€½á€±á€¸á€™á€¾á€¯á€™á€»á€­á€¯á€¸ á€…á€á€„á€ºá€™á€œá€²á‹</h3>
                        <div class="d-grid gap-3">
                            <div class="row g-3">
                                <div class="col-md-6"><button id="startMorningBtn" class="btn btn-primary w-100 p-3">ğŸŒ… á€™á€”á€€á€ºá€á€„á€ºá€¸</button></div>
                                <div class="col-md-6"><button id="startNightBtn" class="btn btn-primary w-100 p-3">ğŸŒƒ á€Šá€•á€­á€¯á€„á€ºá€¸</button></div>
                            </div>
                            <button id="startGratitudeBtn" class="btn btn-primary p-3" style="background-color: #059669; border-color: #059669;">ğŸ™ á€€á€»á€±á€¸á€‡á€°á€¸á€á€„á€ºá€á€¼á€„á€ºá€¸</button>
                            <button id="startGeneralBtn" class="btn btn-secondary p-3">ğŸ’¬ á€¡á€‘á€½á€±á€‘á€½á€±</button>
                            <hr>
                            <button id="myJournalBtn" class="btn btn-outline-primary p-3">ğŸ“– á€€á€»á€½á€”á€ºá€¯á€•á€ºá á€™á€¾á€á€ºá€á€™á€ºá€¸á€™á€»á€¬á€¸</button>
                        </div>
                    </div>
                </div>

                <!-- á€™á€±á€¸á€á€½á€”á€ºá€¸á€™á€»á€¬á€¸ á€€á€á€¹á€ -->
                <div id="promptsSection" class="section hidden">
                    <h2 id="prompt-title" class="h3 fw-bold text-center mb-4"></h2>
                    <div class="progress mb-3" role="progressbar" aria-label="á€™á€±á€¸á€á€½á€”á€ºá€¸á€á€­á€¯á€¸á€á€€á€ºá€™á€¾á€¯" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="height: 8px;">
                        <div id="progressBar" class="progress-bar" style="transition: width 0.5s ease-in-out;"></div>
                    </div>
                    <div class="p-4 rounded mb-3" style="background-color: #eef2f7;">
                        <p id="currentPromptText" class="h5 mb-3"></p>
                        <textarea id="promptAnswerTextarea" class="form-control" rows="5" placeholder="á€á€„á€·á€ºá€¡á€–á€¼á€±á€€á€­á€¯ á€¤á€”á€±á€›á€¬á€á€½á€„á€º á€›á€±á€¸á€•á€«"></textarea>
                    </div>
                    <div class="d-flex justify-content-between align-items-center">
                        <button id="prevPromptBtn" class="btn btn-secondary" disabled>á€šá€á€„á€º</button>
                        <span id="promptCounter" class="text-muted fw-bold"></span>
                        <button id="nextPromptBtn" class="btn btn-primary">á€”á€±á€¬á€€á€ºá€á€…á€ºá€á€¯</button>
                        <button id="combineAnswersBtn" class="btn btn-success hidden">á€¡á€€á€¼á€¶á€‰á€¬á€á€ºá€›á€šá€°á€™á€Šá€º</button>
                    </div>
                    <div class="text-center mt-3">
                        <button id="backToMainFromPromptsBtn" class="btn btn-sm btn-outline-secondary">á€•á€„á€ºá€™ Screen á€á€­á€¯á€· á€•á€¼á€”á€ºá€á€½á€¬á€¸á€›á€”á€º</button>
                    </div>
                </div>
                
                <!-- á€™á€¾á€á€ºá€á€™á€ºá€¸á€™á€¾á€á€ºá€›á€¬á€™á€»á€¬á€¸ á€€á€á€¹á€ -->
                <div id="journalHistorySection" class="section hidden">
                    <h2 class="h3 fw-bold text-center mb-4">á€€á€»á€½á€”á€ºá€¯á€•á€ºá á€™á€¾á€á€ºá€á€™á€ºá€¸á€™á€»á€¬á€¸</h2>
                    <div class="row g-2 mb-3">
                        <div class="col">
                            <select id="filterMode" class="form-select form-select-sm">
                                <option value="all">á€¡á€™á€»á€­á€¯á€¸á€¡á€…á€¬á€¸á€¡á€¬á€¸á€œá€¯á€¶á€¸</option>
                                <option value="morning">á€™á€”á€€á€ºá€á€„á€ºá€¸</option>
                                <option value="night">á€Šá€•á€­á€¯á€„á€ºá€¸</option>
                                <option value="gratitude">á€€á€»á€±á€¸á€‡á€°á€¸á€á€„á€ºá€á€¼á€„á€ºá€¸</option>
                                <option value="general">á€¡á€‘á€½á€±á€‘á€½á€±</option>
                            </select>
                        </div>
                        <div class="col">
                            <select id="filterMood" class="form-select form-select-sm">
                                <option value="all">á€…á€­á€á€ºá€á€¶á€…á€¬á€¸á€™á€¾á€¯á€¡á€¬á€¸á€œá€¯á€¶á€¸</option>
                                <option value="á€•á€»á€±á€¬á€ºá€›á€½á€¾á€„á€º">á€•á€»á€±á€¬á€ºá€›á€½á€¾á€„á€º</option>
                                <option value="á€á€™á€ºá€¸á€”á€Šá€ºá€¸">á€á€™á€ºá€¸á€”á€Šá€ºá€¸</option>
                                <option value="á€…á€­á€á€ºá€á€­á€¯">á€…á€­á€á€ºá€á€­á€¯</option>
                                <option value="á€…á€­á€á€ºá€œá€¾á€¯á€•á€ºá€›á€¾á€¬á€¸">á€…á€­á€á€ºá€œá€¾á€¯á€•á€ºá€›á€¾á€¬á€¸</option>
                                <option value="á€„á€¼á€­á€™á€ºá€á€€á€º">á€„á€¼á€­á€™á€ºá€á€€á€º</option>
                                <option value="á€•á€„á€ºá€•á€”á€ºá€¸">á€•á€„á€ºá€•á€”á€ºá€¸</option>
                                <option value="á€…á€­á€á€ºá€›á€¾á€¯á€•á€º">á€…á€­á€á€ºá€›á€¾á€¯á€•á€º</option>
                                <option value="á€€á€»á€±á€”á€•á€º">á€€á€»á€±á€”á€•á€º</option>
                            </select>
                        </div>
                    </div>
                    <div id="historyList" class="list-group"></div>
                    <p id="noHistoryMessage" class="text-center text-muted hidden">á€™á€¾á€á€ºá€á€™á€ºá€¸á€™á€»á€¬á€¸ á€™á€›á€¾á€­á€á€±á€¸á€•á€«á‹</p>
                    <div class="text-center mt-3">
                        <button id="backToMainFromHistoryBtn" class="btn btn-outline-secondary">á€•á€„á€ºá€™ Screen á€á€­á€¯á€· á€•á€¼á€”á€ºá€á€½á€¬á€¸á€›á€”á€º</button>
                    </div>
                </div>

                <!-- á€á€¯á€¶á€¸á€á€•á€ºá€á€»á€€á€ºá€›á€œá€’á€ºá€™á€»á€¬á€¸ á€€á€á€¹á€ -->
                <div id="analysisSection" class="section hidden">
                    <h2 class="h3 fw-bold text-center mb-4">á€á€¯á€¶á€¸á€á€•á€ºá€á€»á€€á€ºá€”á€¾á€„á€·á€º á€¡á€€á€¼á€¶á€•á€¼á€¯á€á€»á€€á€º</h2>
                    <div class="analysis-section p-3 rounded mb-4">
                        <h3 class="h5 mb-2 fw-bold" style="color: #059669;">AI á€¡á€€á€¼á€¶á€•á€¼á€¯á€á€»á€€á€º</h3>
                        <p id="aiSuggestionDisplay" class="text-dark whitespace-pre-wrap"></p>
                    </div>
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h3 class="h5 mb-2 fw-bold">á€á€„á€ºá á€™á€¾á€á€ºá€á€™á€ºá€¸</h3>
                            <textarea id="combinedJournalText" class="form-control" rows="10" readonly></textarea>
                            <div class="d-grid gap-2 d-md-flex justify-content-md-center mt-3">
                                <button id="copyCombinedTextBtn" class="btn btn-success">á€€á€°á€¸á€šá€°á€™á€Šá€º</button>
                                <button id="exportToNotionBtn" class="btn btn-dark">Notion á€á€­á€¯á€· á€‘á€¯á€á€ºá€™á€Šá€º</button>
                            </div>
                        </div>
                    </div>
                    <div class="text-center mt-3">
                        <button id="continueChatWithAIBtn" class="btn btn-primary me-2">AI á€”á€¾á€„á€·á€º á€†á€€á€ºá€œá€€á€ºá€•á€¼á€±á€¬á€†á€­á€¯á€™á€Šá€º</button>
                        <button id="backToMainJournalBtn" class="btn btn-outline-secondary">á€•á€„á€ºá€™ Screen á€á€­á€¯á€· á€•á€¼á€”á€ºá€á€½á€¬á€¸á€›á€”á€º</button>
                    </div>
                </div>

                <!-- AI á€”á€¾á€„á€·á€º á€…á€€á€¬á€¸á€•á€¼á€±á€¬á€á€”á€ºá€¸ á€€á€á€¹á€ -->
                <div id="conversationalAISession" class="section hidden">
                    <h2 class="h3 fw-bold text-center mb-4">AI á€”á€¾á€„á€·á€º á€…á€€á€¬á€¸á€•á€¼á€±á€¬á€á€”á€ºá€¸</h2>
                    <div class="chat-container">
                        <div id="chatHistoryDisplay" class="chat-history">
                            <!-- Chat messages will be appended here -->
                        </div>
                        <div class="chat-input-area">
                            <textarea id="chatInput" class="form-control chat-input" rows="1" placeholder="á€á€„á€·á€ºá€™á€±á€¸á€á€½á€”á€ºá€¸á€€á€­á€¯ á€›á€±á€¸á€•á€«..." oninput="this.style.height = 'auto'; this.style.height = (this.scrollHeight) + 'px';"></textarea>
                            <button id="sendChatBtn" class="btn btn-primary">á€•á€­á€¯á€·á€™á€Šá€º</button>
                        </div>
                    </div>
                    <div class="text-center mt-3">
                        <button id="backToMainFromChatBtn" class="btn btn-outline-secondary">á€•á€„á€ºá€™ Screen á€á€­á€¯á€· á€•á€¼á€”á€ºá€á€½á€¬á€¸á€›á€”á€º</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Toast Container -->
        <div class="toast-container position-fixed bottom-0 end-0 p-3"></div>

        <!-- á€™á€¾á€á€ºá€á€™á€ºá€¸á€¡á€á€±á€¸á€…á€­á€á€ºá€¡á€á€½á€€á€º á€•á€¼á€”á€ºá€á€¯á€¶á€¸á€”á€­á€¯á€„á€ºá€á€±á€¬ Modal -->
        <div class="modal fade" id="entryDetailModal" tabindex="-1" aria-labelledby="entryDetailTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-scrollable modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="entryDetailTitle"></h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="á€•á€­á€á€ºá€›á€”á€º"></button>
                    </div>
                    <div class="modal-body" id="entryDetailBody">
                        <!-- á€¡á€€á€¼á€±á€¬á€„á€ºá€¸á€¡á€›á€¬á€™á€»á€¬á€¸á€€á€­á€¯ á€¤á€”á€±á€›á€¬á€á€½á€„á€º á€‘á€Šá€·á€ºá€á€½á€„á€ºá€¸á€™á€Šá€º -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Local Storage á€œá€¯á€•á€ºá€†á€±á€¬á€„á€ºá€á€»á€€á€ºá€™á€»á€¬á€¸á€¡á€á€½á€€á€º Utility
        const StorageUtil = {
            save: (key, value) => {
                try {
                    localStorage.setItem(key, JSON.stringify(value));
                } catch (e) {
                    console.error("Local Storage á€á€­á€¯á€· á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€›á€¬á€á€½á€„á€º á€¡á€™á€¾á€¬á€¸á€¡á€šá€½á€„á€ºá€¸á€›á€¾á€­á€á€Šá€º:", e);
                }
            },
            load: (key) => {
                try {
                    const value = localStorage.getItem(key);
                    return value ? JSON.parse(value) : null;
                } catch (e) {
                    console.error("Local Storage á€™á€¾ load á€›á€¬á€á€½á€„á€º á€¡á€™á€¾á€¬á€¸á€¡á€šá€½á€„á€ºá€¸á€›á€¾á€­á€á€Šá€º:", e);
                    return null;
                }
            },
            remove: (key) => {
                try {
                    localStorage.removeItem(key);
                } catch (e) {
                    console.error("Local Storage á€™á€¾ remove á€›á€¬á€á€½á€„á€º á€¡á€™á€¾á€¬á€¸á€¡á€šá€½á€„á€ºá€¸á€›á€¾á€­á€á€Šá€º:", e);
                }
            }
        };

        // Gemini API á€á€±á€«á€ºá€†á€­á€¯á€™á€¾á€¯á€™á€»á€¬á€¸
        const GeminiAPI = {
            async fetchPrompts(mode, mood, name, apiKey) {
                let instruction = '';
                // á€¡á€™á€Šá€ºá€–á€¼á€„á€·á€º á€”á€¾á€¯á€á€ºá€†á€€á€ºá€›á€”á€º á€Šá€½á€¾á€”á€ºá€€á€¼á€¬á€¸á€á€»á€€á€º
                const userName = name ? `Their name is ${name}. Greet them by name.` : ''; 
                switch (mode) {
                    case 'morning':
                        instruction = `As a mind therapist for a Burmese user, generate 5 unique and practical questions for a morning reflection in Burmese. Focus on setting a positive intention for today. ${userName}`;
                        break;
                    case 'night':
                        instruction = `As a mind therapist for a Burmese user, generate 5 unique and practical questions for a night reflection in Burmese. Focus on closure and letting go of today. ${userName}`;
                        break;
                    case 'gratitude':
                        instruction = `As a guide for a Burmese user doing gratitude journaling, generate 3 unique and simple questions to list things they are grateful for in Burmese. ${userName}`;
                        break;
                    default: // general
                        instruction = `As a mind therapist for a Burmese user feeling '${mood}', generate 5 unique and conversational questions to explore their feelings in Burmese. ${userName}`;
                }
                const prompt = `${instruction} Tone must be gentle. Format as a JSON array of strings.`;
                return this._makeApiCall(prompt, { type: 'ARRAY', items: { type: 'STRING' } }, apiKey);
            },

            async fetchCounselorAdvice(journalText, mood, mode, apiKey) {
                const prompt = `As a compassionate mind therapist for a Burmese user, they just completed a ${mode} reflection. Their mood is '${mood}'. Their journal entry is below.\n\n---\n${journalText}\n---\n\nRespond in Burmese with empathy and practical guidance relevant to their reflection type (${mode}). 1. Acknowledge feelings. 2. Offer a new perspective. 3. Provide one or two actionable suggestions. 4. End with a warm closing. Your response must be a single, coherent text.`;
                return this._makeApiCall(prompt, null, apiKey, "text/plain");
            },

            async fetchChatResponse(contextJournalText, contextAiSuggestion, chatHistory, userMessage, apiKey) {
                // Gemini API á€¡á€á€½á€€á€º chat history á€€á€­á€¯ á€•á€¼á€„á€ºá€†á€„á€ºá€á€¼á€„á€ºá€¸
                const contents = [
                    {
                        role: "user",
                        parts: [{ text: `á€¤á€á€Šá€ºá€™á€¾á€¬ á€¡á€á€¯á€¶á€¸á€•á€¼á€¯á€á€°á á€™á€¾á€á€ºá€á€™á€ºá€¸á€”á€¾á€„á€·á€º AI á€¡á€€á€¼á€¶á€‰á€¬á€á€ºá€¡á€•á€±á€«á€º á€¡á€á€¼á€±á€á€¶á á€†á€€á€ºá€œá€€á€ºá€•á€¼á€±á€¬á€†á€­á€¯á€á€¼á€„á€ºá€¸á€–á€¼á€…á€ºá€á€Šá€ºá‹

á€™á€°á€›á€„á€ºá€¸á€™á€¾á€á€ºá€á€™á€ºá€¸:
---
${contextJournalText}
---

AI á á€€á€”á€¦á€¸á€¡á€€á€¼á€¶á€‰á€¬á€á€º:
---
${contextAiSuggestion}
---

á€†á€€á€ºá€œá€€á€ºá€•á€¼á€±á€¬á€†á€­á€¯á€™á€¾á€¯á€™á€¾á€á€ºá€á€™á€ºá€¸:` }]
                    }
                ];

                // á€šá€á€„á€º chat history á€™á€»á€¬á€¸á€€á€­á€¯ á€‘á€Šá€·á€ºá€á€½á€„á€ºá€¸á€á€¼á€„á€ºá€¸
                chatHistory.forEach(msg => {
                    contents.push({
                        role: msg.role === 'user' ? 'user' : 'model',
                        parts: [{ text: msg.text }]
                    });
                });

                // á€œá€€á€ºá€›á€¾á€­ user á á€™á€±á€¸á€á€½á€”á€ºá€¸á€€á€­á€¯ á€‘á€Šá€·á€ºá€á€½á€„á€ºá€¸á€á€¼á€„á€ºá€¸
                contents.push({
                    role: "user",
                    parts: [{ text: `á€¡á€á€¯á€¶á€¸á€•á€¼á€¯á€á€°á á€™á€±á€¸á€á€½á€”á€ºá€¸: ${userMessage}` }]
                });

                const prompt = `As a compassionate mind therapist for a Burmese user, continue the conversation. Respond in Burmese with empathy and practical guidance. Keep responses concise and directly address the user's question while maintaining context from the journal and previous advice.`;
                contents[0].parts[0].text += `\n\n${prompt}`; // á€Šá€½á€¾á€”á€ºá€€á€¼á€¬á€¸á€á€»á€€á€ºá€€á€­á€¯ á€¡á€…á€á€½á€„á€º á€‘á€Šá€·á€ºá€á€½á€„á€ºá€¸á€á€¼á€„á€ºá€¸

                return this._makeApiCall(null, null, apiKey, "text/plain", contents);
            },

            async _makeApiCall(prompt, schema, apiKey, responseMimeType = "application/json", contents = null) {
                const model = "gemini-1.5-flash";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${encodeURIComponent(apiKey)}`;
                
                const requestBody = {
                    contents: contents || [{ parts: [{ text: prompt }] }],
                    generationConfig: schema ? { responseMimeType, responseSchema: schema } : { responseMimeType },
                    safetySettings: [
                        { category: 'HARM_CATEGORY_HARASSMENT', threshold: 'BLOCK_NONE' },
                        { category: 'HARM_CATEGORY_HATE_SPEECH', threshold: 'BLOCK_NONE' },
                        { category: 'HARM_CATEGORY_SEXUALLY_EXPLICIT', threshold: 'BLOCK_NONE' },
                        { category: 'HARM_CATEGORY_DANGEROUS_CONTENT', threshold: 'BLOCK_NONE' }
                    ]
                };

                const payload = {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestBody)
                };

                try {
                    const response = await fetch(apiUrl, payload);
                    if (!response.ok) {
                        const err = await response.json().catch(() => ({}));
                        // Check for specific "model overloaded" error
                        if (err?.error?.message && err.error.message.includes("The model is overloaded")) {
                            throw new Error("AI á€…á€”á€…á€º á€á€á€á€¬ á€¡á€œá€¯á€•á€ºá€™á€»á€¬á€¸á€”á€±á€•á€«á€á€Šá€ºá‹ á€á€á€€á€¼á€¬á€•á€¼á€®á€¸á€”á€±á€¬á€€á€º á€‘á€•á€ºá€€á€¼á€­á€¯á€¸á€…á€¬á€¸á€€á€¼á€Šá€·á€ºá€•á€«á‹");
                        }
                        throw new Error(err?.error?.message || `API Error: ${response.status}`);
                    }
                    const result = await response.json();
                    const text = result.candidates?.[0]?.content?.parts?.[0]?.text;

                    if (!text) {
                        throw new Error('á€™á€»á€¾á€±á€¬á€ºá€œá€„á€·á€ºá€™á€‘á€¬á€¸á€á€±á€¬ API á€á€¯á€¶á€·á€•á€¼á€”á€ºá€™á€¾á€¯ á€–á€½á€²á€·á€…á€Šá€ºá€¸á€•á€¯á€¶á‹');
                    }
                    
                    return responseMimeType === "application/json" ? JSON.parse(text) : text;
                } catch (error) {
                    console.error("API á€á€±á€«á€ºá€†á€­á€¯á€™á€¾á€¯ á€™á€¡á€±á€¬á€„á€ºá€™á€¼á€„á€ºá€•á€«:", error);
                    throw error;
                }
            }
        };

        // UI á€”á€¾á€„á€·á€ºá€á€€á€ºá€†á€­á€¯á€„á€ºá€á€±á€¬ Utility á€™á€»á€¬á€¸
        const UIUtil = {
            showSection: (id) => {
                document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
                document.getElementById(id)?.classList.remove('hidden');
            },
            showToast: (msg) => {
                const toastContainer = document.querySelector('.toast-container');
                const toastEl = document.createElement('div');
                toastEl.className = 'toast align-items-center text-bg-dark border-0';
                toastEl.innerHTML = `<div class="d-flex"><div class="toast-body">${msg}</div><button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="á€•á€­á€á€ºá€›á€”á€º"></button></div>`;
                toastContainer.appendChild(toastEl);
                const toast = new bootstrap.Toast(toastEl, { delay: 3000 });
                toast.show();
                toastEl.addEventListener('hidden.bs.toast', () => toastEl.remove()); // toast á€€á€­á€¯ DOM á€™á€¾ á€–á€šá€ºá€›á€¾á€¬á€¸á€›á€”á€º
            },
            setLoading: (el, loading, text) => {
                const spinner = '<span class="loading-spinner"></span>';
                el.disabled = loading;
                el.innerHTML = loading ? spinner + text : text;
            },
            updateProgressBar: (current, total) => {
                const progressBar = document.getElementById('progressBar');
                if (progressBar) {
                    progressBar.style.width = `${(current / total) * 100}%`;
                    progressBar.setAttribute('aria-valuenow', (current / total) * 100);
                }
            },
            addChatMessage: (message, sender) => {
                const chatHistoryDisplay = document.getElementById('chatHistoryDisplay');
                const messageDiv = document.createElement('div');
                messageDiv.className = `chat-message ${sender}`;
                messageDiv.textContent = message;
                chatHistoryDisplay.appendChild(messageDiv);
                chatHistoryDisplay.scrollTop = chatHistoryDisplay.scrollHeight; // Scroll to bottom
            }
        };

        // á€•á€„á€ºá€™ Application Logic
        class JournalApp {
            constructor() {
                this.currentPromptIndex = 0;
                this.promptAnswers = [];
                this.activePrompts = [];
                this.isLoading = false;
                this.journalMode = null;
                this.journalEntries = StorageUtil.load('journalEntries') || [];
                this.userName = StorageUtil.load('userName') || '';
                this.apiKey = StorageUtil.load('geminiApiKey') || '';
                this.defaultPrompts = {
                    morning: ["á€’á€®á€™á€”á€€á€ºá€á€„á€ºá€¸á€™á€¾á€¬ á€˜á€šá€ºá€¡á€›á€¬á€¡á€á€½á€€á€º á€€á€»á€±á€¸á€‡á€°á€¸á€¡á€á€„á€ºá€†á€¯á€¶á€¸á€–á€¼á€…á€ºá€™á€œá€²á‹", "á€’á€®á€”á€±á€·á€€á€­á€¯ á€¡á€€á€±á€¬á€„á€ºá€¸á€†á€¯á€¶á€¸á€”á€±á€·á€–á€¼á€…á€ºá€¡á€±á€¬á€„á€º á€˜á€šá€ºá€œá€­á€¯á€›á€Šá€ºá€›á€½á€šá€ºá€á€»á€€á€ºá€‘á€¬á€¸á€™á€œá€²á‹", "á€á€„á€·á€ºá€€á€­á€¯á€šá€ºá€á€„á€º á€¡á€¬á€¸á€•á€±á€¸á€…á€€á€¬á€¸á€á€…á€ºá€á€½á€”á€ºá€¸ á€•á€¼á€±á€¬á€•á€±á€¸á€•á€«á‹"],
                    night: ["á€’á€®á€”á€±á€· á€á€„á€ºá€šá€°á€œá€­á€¯á€€á€ºá€›á€á€²á€· á€¡á€›á€±á€¸á€€á€¼á€®á€¸á€†á€¯á€¶á€¸á€¡á€›á€¬á€€ á€˜á€¬á€œá€²á‹", "á€˜á€šá€ºá€¡á€–á€¼á€…á€ºá€¡á€•á€»á€€á€ºá€€ á€á€„á€·á€ºá€€á€­á€¯ á€¡á€•á€»á€±á€¬á€ºá€›á€½á€¾á€„á€ºá€†á€¯á€¶á€¸á€–á€¼á€…á€ºá€…á€±á€á€²á€·á€œá€²á‹", "á€’á€®á€”á€±á€·á€¡á€á€½á€€á€º á€œá€½á€¾á€á€ºá€á€»á€á€»á€„á€ºá€á€²á€· á€…á€­á€á€ºá€¡á€”á€¾á€±á€¬á€„á€·á€ºá€¡á€šá€¾á€€á€º á€á€…á€ºá€á€¯á€á€¯á€›á€¾á€­á€œá€¬á€¸á‹"],
                    gratitude: ["á€’á€®á€”á€±á€·á€¡á€á€½á€€á€º á€€á€»á€±á€¸á€‡á€°á€¸á€á€„á€ºá€™á€­á€á€²á€· á€•á€‘á€™á€†á€¯á€¶á€¸á€¡á€›á€¬á€€ á€˜á€¬á€œá€²á‹", "á€”á€±á€¬á€€á€ºá€‘á€•á€º á€€á€»á€±á€¸á€‡á€°á€¸á€á€„á€ºá€…á€›á€¬á€á€…á€ºá€á€¯á€€ á€˜á€¬á€–á€¼á€…á€ºá€™á€œá€²á‹", "á€”á€±á€¬á€€á€ºá€†á€¯á€¶á€¸á€¡á€”á€±á€”á€²á€· á€á€á€­á€šá€™á€¼á€±á€¬á€€á€º á€€á€»á€±á€¸á€‡á€°á€¸á€á€„á€ºá€…á€›á€¬á€€á€›á€±á€¬ á€˜á€¬á€–á€¼á€…á€ºá€™á€œá€²á‹"],
                    general: ["á€’á€®á€”á€±á€· á€á€„á€·á€ºá€…á€­á€á€ºá€‘á€²á€™á€¾á€¬ á€˜á€¬á€á€½á€±á€–á€¼á€…á€ºá€”á€±á€œá€²á‹", "á€¡á€²á€·á€’á€®á€á€¶á€…á€¬á€¸á€á€»á€€á€ºá€€á€­á€¯ á€–á€¼á€…á€ºá€…á€±á€á€²á€· á€¡á€€á€¼á€±á€¬á€„á€ºá€¸á€›á€„á€ºá€¸á€€ á€˜á€¬á€–á€¼á€…á€ºá€™á€œá€²á‹", "á€á€„á€·á€ºá€¡á€á€½á€€á€º á€˜á€¬á€œá€¯á€•á€ºá€•á€±á€¸á€›á€„á€º á€…á€­á€á€ºá€á€€á€ºá€á€¬á€›á€¬á€›á€™á€œá€²á‹"]
                };
                this.currentJournalTextForChat = '';
                this.currentAiSuggestionForChat = '';
                this.chatHistory = []; // Current session chat history
                this.init();
            }

            init() {
                this.bindEvents();
                this.checkInitialState();
            }

            bindEvents() {
                // á€€á€”á€¦á€¸ onboarding á€”á€¾á€„á€·á€º á€á€»á€­á€”á€ºá€Šá€¾á€­á€™á€¾á€¯á€™á€»á€¬á€¸
                document.getElementById('agreePrivacyBtn').onclick = () => {
                    StorageUtil.save('agreedPrivacy', true);
                    UIUtil.showSection('termsSection');
                };
                document.getElementById('agreeTermsBtn').onclick = () => {
                    StorageUtil.save('agreedTerms', true);
                    this.loadSettingsIntoUI(); // á€›á€¾á€­á€•á€¼á€®á€¸á€á€¬á€¸ á€á€»á€­á€”á€ºá€Šá€¾á€­á€™á€¾á€¯á€™á€»á€¬á€¸ á€›á€¾á€­á€•á€«á€€ load á€œá€¯á€•á€ºá€›á€”á€º
                    UIUtil.showSection('settingsSection');
                };
                document.getElementById('settingsBtn').onclick = () => {
                    this.loadSettingsIntoUI();
                    UIUtil.showSection('settingsSection');
                };
                document.getElementById('saveSettingsBtn').onclick = () => this.saveSettings();
                document.getElementById('exportSettingsBtn').onclick = () => this.exportSettings();
                document.getElementById('importSettingsBtn').onclick = () => document.getElementById('importFileInput').click();
                document.getElementById('importFileInput').onchange = (e) => this.importSettings(e);

                // á€•á€„á€ºá€™á€™á€¾á€á€ºá€á€™á€ºá€¸ session á€á€œá€¯á€á€ºá€™á€»á€¬á€¸
                document.getElementById('startMorningBtn').onclick = () => this.startJournalingSession('morning');
                document.getElementById('startNightBtn').onclick = () => this.startJournalingSession('night');
                document.getElementById('startGratitudeBtn').onclick = () => this.startJournalingSession('gratitude');
                document.getElementById('startGeneralBtn').onclick = () => this.startJournalingSession('general');
                document.getElementById('myJournalBtn').onclick = () => this.renderJournalHistory();

                // á€™á€±á€¸á€á€½á€”á€ºá€¸á€™á€»á€¬á€¸ á€œá€™á€ºá€¸á€Šá€½á€¾á€”á€ºá€á€¼á€„á€ºá€¸á€”á€¾á€„á€·á€º á€•á€¼á€®á€¸á€…á€®á€¸á€á€¼á€„á€ºá€¸
                document.getElementById('prevPromptBtn').onclick = () => this.previousPrompt();
                document.getElementById('nextPromptBtn').onclick = () => this.nextPrompt();
                document.getElementById('combineAnswersBtn').onclick = () => this.combineAnswers();

                // á€á€½á€²á€á€¼á€™á€ºá€¸á€…á€­á€á€ºá€–á€¼á€¬á€™á€¾á€¯ á€€á€á€¹á€ á€œá€¯á€•á€ºá€†á€±á€¬á€„á€ºá€á€»á€€á€ºá€™á€»á€¬á€¸
                document.getElementById('copyCombinedTextBtn').onclick = () => this.copyJournalText();
                document.getElementById('exportToNotionBtn').onclick = () => this.exportToNotion();
                document.getElementById('backToMainJournalBtn').onclick = () => this.showJournalSection();
                document.getElementById('continueChatWithAIBtn').onclick = () => this.startConversationalAI();


                // á€”á€±á€¬á€€á€ºá€•á€¼á€”á€ºá€á€œá€¯á€á€ºá€™á€»á€¬á€¸
                document.getElementById('backToMainFromPromptsBtn').onclick = () => this.showJournalSection();
                document.getElementById('backToMainFromHistoryBtn').onclick = () => this.showJournalSection();
                document.getElementById('backToMainFromChatBtn').onclick = () => this.showJournalSection();

                // á€™á€¾á€á€ºá€á€™á€ºá€¸á€™á€¾á€á€ºá€›á€¬ á€…á€…á€ºá€‘á€¯á€á€ºá€™á€¾á€¯á€™á€»á€¬á€¸
                document.getElementById('filterMode').onchange = () => this.renderJournalHistory();
                document.getElementById('filterMood').onchange = () => this.renderJournalHistory();

                // Chat UI events
                document.getElementById('sendChatBtn').onclick = () => this.sendChatMessage();
                document.getElementById('chatInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault(); // Prevent new line
                        this.sendChatMessage();
                    }
                });
            }

            checkInitialState() {
                if (!StorageUtil.load('agreedPrivacy')) {
                    UIUtil.showSection('privacySection');
                } else if (!StorageUtil.load('agreedTerms')) {
                    UIUtil.showSection('termsSection');
                } else if (!this.apiKey || !this.userName) {
                    this.loadSettingsIntoUI(); // á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸ á€á€…á€ºá€…á€­á€á€ºá€á€…á€ºá€•á€­á€¯á€„á€ºá€¸á€›á€¾á€­á€•á€«á€€ inputs á€™á€»á€¬á€¸á€á€½á€„á€º á€–á€¼á€Šá€·á€ºá€á€½á€„á€ºá€¸á€›á€”á€º
                    UIUtil.showSection('settingsSection');
                } else {
                    this.showJournalSection();
                }
            }

            showJournalSection() {
                UIUtil.showSection('journalSection');
                document.getElementById('journalDate').valueAsDate = new Date(); // á€šá€”á€±á€·á€›á€€á€ºá€…á€½á€² á€á€á€ºá€™á€¾á€á€ºá€›á€”á€º
                document.getElementById('journalMood').value = ""; // á€…á€­á€á€ºá€á€¶á€…á€¬á€¸á€™á€¾á€¯ á€›á€½á€±á€¸á€á€»á€šá€ºá€™á€¾á€¯á€€á€­á€¯ á€•á€¼á€”á€ºá€œá€Šá€ºá€á€á€ºá€™á€¾á€á€ºá€›á€”á€º
            }

            loadSettingsIntoUI() {
                document.getElementById('userNameInput').value = this.userName;
                document.getElementById('apiKeyInput').value = this.apiKey;
            }

            saveSettings() {
                this.userName = document.getElementById('userNameInput').value.trim();
                this.apiKey = document.getElementById('apiKeyInput').value.trim();

                if (!this.userName || !this.apiKey) {
                    UIUtil.showToast('á€¡á€™á€Šá€ºá€”á€¾á€„á€·á€º API Key á€–á€¼á€Šá€·á€ºá€…á€½á€€á€ºá€›á€”á€º á€œá€­á€¯á€¡á€•á€ºá€•á€«á€á€Šá€ºá‹');
                    return;
                }

                StorageUtil.save('userName', this.userName);
                StorageUtil.save('geminiApiKey', this.apiKey);
                UIUtil.showToast('á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€•á€¼á€®á€¸á€•á€«á€•á€¼á€®á‹');
                this.showJournalSection();
            }

            exportSettings() {
                const settings = {
                    userName: this.userName,
                    apiKey: this.apiKey
                };
                const blob = new Blob([JSON.stringify(settings, null, 2)], { type: 'application/json' });
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = 'journal_settings.json';
                a.click();
                URL.revokeObjectURL(a.href);
                UIUtil.showToast('Settings file á€€á€­á€¯ download á€œá€¯á€•á€ºá€•á€¼á€®á€¸á€•á€«á€•á€¼á€®á‹');
            }

            importSettings(event) {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const settings = JSON.parse(e.target.result);
                        if (settings.apiKey && settings.userName) {
                            this.apiKey = settings.apiKey;
                            this.userName = settings.userName;
                            this.saveSettings(); // á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€•á€¼á€®á€¸ UI á€€á€­á€¯ update á€œá€¯á€•á€ºá€›á€”á€º
                        } else {
                            UIUtil.showToast('File format á€™á€™á€¾á€”á€ºá€•á€«á‹');
                        }
                    } catch (err) {
                        UIUtil.showToast('File á€€á€­á€¯ á€™á€–á€á€ºá€”á€­á€¯á€„á€ºá€•á€«á‹');
                        console.error("á€á€»á€­á€”á€ºá€Šá€¾á€­á€™á€¾á€¯á€™á€»á€¬á€¸ á€‘á€Šá€·á€ºá€á€½á€„á€ºá€¸á€›á€¬á€á€½á€„á€º á€¡á€™á€¾á€¬á€¸á€¡á€šá€½á€„á€ºá€¸á€›á€¾á€­á€á€Šá€º:", err);
                    }
                };
                reader.readAsText(file);
                // file input á€€á€­á€¯ á€›á€¾á€„á€ºá€¸á€œá€„á€ºá€¸á€›á€”á€º
                event.target.value = '';
            }

            async startJournalingSession(mode) {
                if (this.isLoading) return; // á€á€œá€¯á€á€ºá€™á€»á€¬á€¸ á€‘á€•á€ºá€”á€¾á€­á€•á€ºá€á€¼á€„á€ºá€¸á€€á€­á€¯ á€€á€¬á€€á€½á€šá€ºá€›á€”á€º

                this.journalMode = mode;
                const mood = document.getElementById('journalMood').value;
                
                // 'general' mode á€¡á€á€½á€€á€ºá€á€¬ á€…á€­á€á€ºá€á€¶á€…á€¬á€¸á€™á€¾á€¯ á€›á€½á€±á€¸á€á€»á€šá€ºá€›á€”á€º á€œá€­á€¯á€¡á€•á€ºá€•á€«á€á€Šá€ºá‹
                if (this.journalMode === 'general' && !mood) {
                    UIUtil.showToast('á€œá€€á€ºá€›á€¾á€­á€…á€­á€á€ºá€á€¶á€…á€¬á€¸á€™á€¾á€¯ á€€á€­á€¯ á€›á€½á€±á€¸á€á€»á€šá€ºá€•á€±á€¸á€•á€«á‹'); // "á€œá€€á€ºá€›á€¾á€­á€…á€­á€á€ºá€á€¶á€…á€¬á€¸á€™á€¾á€¯á€€á€­á€¯ á€›á€½á€±á€¸á€á€»á€šá€ºá€•á€±á€¸á€•á€«á‹"
                    return;
                }
                if (!this.apiKey) {
                    UIUtil.showToast('á€€á€»á€±á€¸á€‡á€°á€¸á€•á€¼á€¯á Settings á€á€½á€„á€º API Key á€‘á€Šá€·á€ºá€•á€«á‹');
                    return;
                }

                this.isLoading = true;
                const btn = document.getElementById(`start${mode.charAt(0).toUpperCase() + mode.slice(1)}Btn`);
                const originalText = btn.innerHTML;
                UIUtil.setLoading(btn, true, 'á€•á€¼á€„á€ºá€†á€„á€ºá€”á€±á€á€Šá€º...');

                try {
                    // mood á€€á€­á€¯ 'general' mode á€¡á€á€½á€€á€ºá€á€¬ á€•á€±á€¸á€•á€­á€¯á€·á€•á€«á€™á€Šá€ºá‹
                    const actualMood = this.journalMode === 'general' ? mood : ''; 
                    this.activePrompts = await GeminiAPI.fetchPrompts(this.journalMode, actualMood, this.userName, this.apiKey);
                } catch (error) {
                    console.error('á€™á€±á€¸á€á€½á€”á€ºá€¸á€™á€»á€¬á€¸ á€›á€šá€°á€›á€¬á€á€½á€„á€º á€¡á€™á€¾á€¬á€¸á€¡á€šá€½á€„á€ºá€¸á€›á€¾á€­á€á€Šá€º:', error);
                    // Check if the error is due to model overload
                    if (error.message.includes("AI á€…á€”á€…á€º á€á€á€á€¬ á€¡á€œá€¯á€•á€ºá€™á€»á€¬á€¸á€”á€±á€•á€«á€á€Šá€ºá‹")) {
                        UIUtil.showToast(error.message); // Show the specific overloaded message
                    } else {
                        UIUtil.showToast(`AI á€™á€¾á€™á€±á€¸á€á€½á€”á€ºá€¸á€™á€»á€¬á€¸á€›á€šá€°áá€™á€›á€•á€«áŠ Default á€™á€±á€¸á€á€½á€”á€ºá€¸á€™á€»á€¬á€¸á€–á€¼á€„á€·á€º á€†á€€á€ºá€•á€«á€™á€Šá€ºá‹`);
                    }
                    this.activePrompts = this.defaultPrompts[this.journalMode];
                } finally {
                    this.isLoading = false;
                    UIUtil.setLoading(btn, false, originalText); // á€á€œá€¯á€á€ºá€…á€¬á€á€¬á€¸á€€á€­á€¯ á€•á€¼á€”á€ºá€œá€Šá€ºá€á€á€ºá€™á€¾á€á€ºá€›á€”á€º

                    if (this.activePrompts?.length) {
                        this.currentPromptIndex = 0;
                        this.promptAnswers = Array(this.activePrompts.length).fill('');
                        document.getElementById('prompt-title').textContent = btn.innerText; // á€á€œá€¯á€á€ºá€…á€¬á€á€¬á€¸á€•á€±á€«á€ºá€™á€°á€á€Šá€ºá á€á€±á€«á€„á€ºá€¸á€…á€‰á€º á€á€á€ºá€™á€¾á€á€ºá€›á€”á€º
                        this.displayCurrentPrompt();
                        UIUtil.showSection('promptsSection');
                    }
                }
            }

            displayCurrentPrompt() {
                document.getElementById('currentPromptText').textContent = this.activePrompts[this.currentPromptIndex];
                document.getElementById('promptAnswerTextarea').value = this.promptAnswers[this.currentPromptIndex] || '';
                document.getElementById('promptAnswerTextarea').focus(); // á€¡á€œá€­á€¯á€¡á€œá€»á€±á€¬á€€á€º focus á€œá€¯á€•á€ºá€›á€”á€º

                document.getElementById('promptCounter').textContent = `${this.currentPromptIndex + 1}/${this.activePrompts.length}`;
                document.getElementById('prevPromptBtn').disabled = (this.currentPromptIndex === 0);

                const isLast = this.currentPromptIndex === this.activePrompts.length - 1;
                document.getElementById('nextPromptBtn').classList.toggle('hidden', isLast);
                document.getElementById('combineAnswersBtn').classList.toggle('hidden', !isLast);
                
                UIUtil.updateProgressBar(this.currentPromptIndex + 1, this.activePrompts.length);
            }

            saveCurrentAnswer() {
                this.promptAnswers[this.currentPromptIndex] = document.getElementById('promptAnswerTextarea').value.trim();
            }

            previousPrompt() {
                this.saveCurrentAnswer();
                if (this.currentPromptIndex > 0) {
                    this.currentPromptIndex--;
                    this.displayCurrentPrompt();
                }
            }

            nextPrompt() {
                this.saveCurrentAnswer();
                if (this.currentPromptIndex < this.activePrompts.length - 1) {
                    this.currentPromptIndex++;
                    this.displayCurrentPrompt();
                }
            }

            async combineAnswers() {
                if (this.isLoading) return;
                this.saveCurrentAnswer(); // á€”á€±á€¬á€€á€ºá€†á€¯á€¶á€¸á€™á€±á€¸á€á€½á€”á€ºá€¸á€¡á€á€½á€€á€º á€¡á€–á€¼á€±á€€á€­á€¯ á€á€­á€™á€ºá€¸á€›á€”á€º

                this.isLoading = true;
                const combineBtn = document.getElementById('combineAnswersBtn');
                const originalText = combineBtn.innerHTML;
                UIUtil.setLoading(combineBtn, true, 'á€†á€±á€¬á€„á€ºá€›á€½á€€á€ºá€”á€±á€á€Šá€º...');
                UIUtil.showToast('AI á€¡á€€á€¼á€¶á€•á€¼á€¯á€á€»á€€á€º á€›á€šá€°á€”á€±á€•á€«á€á€Šá€ºá‹');

                const date = document.getElementById('journalDate').value;
                const mood = document.getElementById('journalMood').value;
                const time = new Date().toLocaleTimeString('en-GB'); // á€¡á€á€»á€­á€”á€ºá€•á€¯á€¶á€…á€¶

                const header = `á€›á€€á€ºá€…á€½á€²: ${date}\ná€¡á€á€»á€­á€”á€º: ${time}\ná€…á€­á€á€ºá€á€¶á€…á€¬á€¸á€™á€¾á€¯: ${mood}\n\n---\n\n`;
                
                // á€™á€±á€¸á€á€½á€”á€ºá€¸á€”á€¾á€„á€·á€º á€¡á€–á€¼á€±á€™á€»á€¬á€¸á€€á€­á€¯ á€•á€±á€«á€„á€ºá€¸á€…á€•á€ºá€•á€¼á€®á€¸ á€•á€¯á€¶á€…á€¶á€á€»á€›á€”á€º
                const combinedAnswers = this.promptAnswers.map((answer, i) => {
                    return answer ? `${i + 1}. ${this.activePrompts[i]}\ná€¡á€–á€¼á€±: ${answer}` : '';
                }).filter(Boolean).join('\n\n---\n\n'); // á€•á€­á€¯á€„á€ºá€¸á€á€¼á€¬á€¸á€™á€¾á€¯á€–á€¼á€„á€·á€º á€•á€±á€«á€„á€ºá€¸á€…á€•á€ºá€›á€”á€º

                const fullJournalText = header + combinedAnswers;
                document.getElementById('combinedJournalText').value = fullJournalText; // textarea á€á€½á€„á€º á€•á€¼á€á€›á€”á€º

                try {
                    const advice = await GeminiAPI.fetchCounselorAdvice(combinedAnswers, mood, this.journalMode, this.apiKey);
                    document.getElementById('aiSuggestionDisplay').textContent = advice;

                    // á€…á€€á€¬á€¸á€•á€¼á€±á€¬á€á€”á€ºá€¸á€¡á€á€½á€€á€º context á€€á€­á€¯ á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€›á€”á€º
                    this.currentJournalTextForChat = fullJournalText;
                    this.currentAiSuggestionForChat = advice;
                    this.chatHistory = []; // á€…á€€á€¬á€¸á€•á€¼á€±á€¬á€á€”á€ºá€¸á€¡á€á€…á€ºá€…á€á€„á€ºá€á€­á€¯á€„á€ºá€¸ chat history á€€á€­á€¯ á€›á€¾á€„á€ºá€¸á€œá€„á€ºá€¸á€›á€”á€º

                    // á€™á€¾á€á€ºá€á€™á€ºá€¸á€¡á€á€…á€ºá€€á€­á€¯ history á€á€½á€„á€º á€á€­á€™á€ºá€¸á€›á€”á€º
                    const newEntry = {
                        date,
                        time,
                        mood,
                        mode: this.journalMode,
                        text: fullJournalText,
                        aiSuggestion: advice
                    };
                    this.journalEntries.push(newEntry);
                    StorageUtil.save('journalEntries', this.journalEntries);
                } catch (error) {
                    console.error('á€¡á€€á€¼á€¶á€‰á€¬á€á€ºá€›á€šá€°á€›á€¬á€á€½á€„á€º á€¡á€™á€¾á€¬á€¸á€¡á€šá€½á€„á€ºá€¸á€›á€¾á€­á€á€Šá€º:', error);
                    // Check if the error is due to model overload
                    if (error.message.includes("AI á€…á€”á€…á€º á€á€á€á€¬ á€¡á€œá€¯á€•á€ºá€™á€»á€¬á€¸á€”á€±á€•á€«á€á€Šá€ºá‹")) {
                        UIUtil.showToast(error.message); // Show the specific overloaded message
                    } else {
                        UIUtil.showToast(`á€¡á€€á€¼á€¶á€•á€¼á€¯á€á€»á€€á€ºá€›á€šá€°á€›á€¬á€á€½á€„á€º á€•á€¼á€¿á€”á€¬á€›á€¾á€­á€á€²á€·á€•á€«á€á€Šá€ºá‹`);
                        document.getElementById('aiSuggestionDisplay').textContent = "á€á€±á€¬á€„á€ºá€¸á€•á€”á€ºá€•á€«á€á€šá€ºáŠ á€¡á€á€¯á€á€»á€­á€”á€ºá€™á€¾á€¬ AI á€”á€²á€· á€á€»á€­á€á€ºá€†á€€á€ºá€œá€­á€¯á€·á€™á€›á€á€±á€¸á€•á€«á‹";
                    }
                } finally {
                    this.isLoading = false;
                    UIUtil.setLoading(combineBtn, false, originalText); // á€á€œá€¯á€á€ºá€…á€¬á€á€¬á€¸á€€á€­á€¯ á€•á€¼á€”á€ºá€œá€Šá€ºá€á€á€ºá€™á€¾á€á€ºá€›á€”á€º
                    UIUtil.showSection('analysisSection');
                }
            }

            copyJournalText() {
                navigator.clipboard.writeText(document.getElementById('combinedJournalText').value)
                    .then(() => UIUtil.showToast('á€™á€¾á€á€ºá€á€™á€ºá€¸ á€€á€°á€¸á€šá€°á€•á€¼á€®á€¸á€•á€«á€•á€¼á€®á‹'))
                    .catch(err => console.error('á€…á€¬á€á€¬á€¸á€€á€°á€¸á€šá€°á€›á€”á€º á€™á€¡á€±á€¬á€„á€ºá€™á€¼á€„á€ºá€•á€«: ', err));
            }

            exportToNotion() {
                const fullText = document.getElementById('combinedJournalText').value;
                const advice = document.getElementById('aiSuggestionDisplay').textContent;
                const date = document.getElementById('journalDate').value;
                
                // á€¡á€á€¼á€±á€á€¶ Markdown á€•á€¯á€¶á€…á€¶
                let markdown = `# á€™á€¾á€á€ºá€á€™á€ºá€¸ - ${date} (${this.journalMode === 'morning' ? 'á€™á€”á€€á€ºá€á€„á€ºá€¸' : this.journalMode === 'night' ? 'á€Šá€•á€­á€¯á€„á€ºá€¸' : this.journalMode === 'gratitude' ? 'á€€á€»á€±á€¸á€‡á€°á€¸á€á€„á€ºá€á€¼á€„á€ºá€¸' : 'á€¡á€‘á€½á€±á€‘á€½á€±'})\n\n`;
                markdown += fullText.replace(/\n/g, '\n\n'); // Markdown á€›á€¾á€­ á€…á€¬á€•á€­á€¯á€’á€ºá€á€½á€²á€™á€»á€¬á€¸á€¡á€á€½á€€á€º double newline á€á€±á€á€»á€¬á€…á€±á€›á€”á€º
                markdown += `\n\n---\n\n## AI á€¡á€€á€¼á€¶á€•á€¼á€¯á€á€»á€€á€º\n\n`;
                markdown += `> ${advice.replace(/\n/g, '\n> ')}`; // AI á€¡á€€á€¼á€¶á€‰á€¬á€á€ºá€¡á€á€½á€€á€º Blockquote

                const blob = new Blob([markdown], { type: 'text/markdown;charset=utf-8' });
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = `Journal_${date}_${this.journalMode}.md`;
                a.click();
                URL.revokeObjectURL(a.href);
                UIUtil.showToast('Notion á€–á€­á€¯á€„á€º á€‘á€¯á€á€ºá€šá€°á€•á€¼á€®á€¸á€•á€«á€•á€¼á€®á‹');
            }

            renderJournalHistory() {
                UIUtil.showSection('journalHistorySection');
                const historyList = document.getElementById('historyList');
                const noHistoryMessage = document.getElementById('noHistoryMessage');
                const filterMode = document.getElementById('filterMode').value;
                const filterMood = document.getElementById('filterMood').value;
                
                historyList.innerHTML = ''; // á€šá€á€„á€º entries á€™á€»á€¬á€¸á€€á€­á€¯ á€›á€¾á€„á€ºá€¸á€œá€„á€ºá€¸á€›á€”á€º

                const filteredEntries = this.journalEntries
                    .filter(entry => (filterMode === 'all' || entry.mode === filterMode))
                    .filter(entry => (filterMood === 'all' || entry.mood === filterMood));

                if (filteredEntries.length === 0) {
                    noHistoryMessage.classList.remove('hidden');
                } else {
                    noHistoryMessage.classList.add('hidden');
                    // á€›á€€á€ºá€…á€½á€²á€¡á€œá€­á€¯á€€á€º á€¡á€…á€‰á€ºá€œá€­á€¯á€€á€º (á€¡á€á€…á€ºá€†á€¯á€¶á€¸á€€á€­á€¯ á€¡á€›á€„á€º) á€…á€®á€›á€”á€º
                    filteredEntries.sort((a,b) => new Date(b.date) - new Date(a.date)).forEach((entry, index) => {
                        const item = document.createElement('a');
                        item.href = '#'; // á€”á€¾á€­á€•á€ºáá€›á€…á€±á€›á€”á€ºáŠ á€á€­á€¯á€·á€á€±á€¬á€º á€™á€°á€›á€„á€ºá€¸ navigation á€€á€­á€¯ á€á€¬á€¸á€†á€®á€¸á€›á€”á€º
                        item.className = 'list-group-item list-group-item-action history-item';
                        item.innerHTML = `
                            <div class="d-flex w-100 justify-content-between">
                                <h5 class="mb-1">${entry.date} - ${entry.mode === 'morning' ? 'á€™á€”á€€á€ºá€á€„á€ºá€¸' : entry.mode === 'night' ? 'á€Šá€•á€­á€¯á€„á€ºá€¸' : entry.mode === 'gratitude' ? 'á€€á€»á€±á€¸á€‡á€°á€¸á€á€„á€ºá€á€¼á€„á€ºá€¸' : 'á€¡á€‘á€½á€±á€‘á€½á€±'}</h5>
                                <small>${entry.time}</small>
                            </div>
                            <p class="mb-1">á€…á€­á€á€ºá€á€¶á€…á€¬á€¸á€™á€¾á€¯: ${entry.mood}</p>
                            <small class="text-muted">${entry.text.substring(0, 100)}...</small>
                        `;
                        item.onclick = (e) => {
                            e.preventDefault(); // á€…á€¬á€™á€»á€€á€ºá€”á€¾á€¬ reload á€€á€­á€¯ á€á€¬á€¸á€†á€®á€¸á€›á€”á€º
                            this.showJournalEntryDetail(entry);
                        };
                        historyList.appendChild(item);
                    });
                }
            }

            showJournalEntryDetail(entry) {
                const detailModal = new bootstrap.Modal(document.getElementById('entryDetailModal'));
                document.getElementById('entryDetailTitle').textContent = `${entry.date} - ${entry.mode === 'morning' ? 'á€™á€”á€€á€ºá€á€„á€ºá€¸' : entry.mode === 'night' ? 'á€Šá€•á€­á€¯á€„á€ºá€¸' : entry.mode === 'gratitude' ? 'á€€á€»á€±á€¸á€‡á€°á€¸á€á€„á€ºá€á€¼á€„á€ºá€¸' : 'á€¡á€‘á€½á€±á€‘á€½á€±'} á€™á€¾á€á€ºá€á€™á€ºá€¸`;
                document.getElementById('entryDetailBody').innerHTML = `
                    <h5 class="fw-bold">AI á€¡á€€á€¼á€¶á€•á€¼á€¯á€á€»á€€á€º</h5>
                    <p class="whitespace-pre-wrap p-2 rounded" style="background-color: #f0fff4;">${entry.aiSuggestion}</p>
                    <hr>
                    <h5 class="fw-bold mt-3">á€á€„á€ºá á€™á€¾á€á€ºá€á€™á€ºá€¸á€¡á€•á€¼á€Šá€·á€ºá€¡á€…á€¯á€¶</h5>
                    <textarea class="form-control" rows="15" readonly>${entry.text}</textarea>
                `;
                detailModal.show();
            }

            // AI á€”á€¾á€„á€·á€º á€…á€€á€¬á€¸á€•á€¼á€±á€¬á€á€”á€ºá€¸ á€…á€á€„á€ºá€á€¼á€„á€ºá€¸
            startConversationalAI() {
                UIUtil.showSection('conversationalAISession');
                document.getElementById('chatHistoryDisplay').innerHTML = ''; // á€šá€á€„á€º chat history á€€á€­á€¯ á€›á€¾á€„á€ºá€¸á€œá€„á€ºá€¸á€›á€”á€º
                this.chatHistory = []; // chat history array á€€á€­á€¯ á€›á€¾á€„á€ºá€¸á€œá€„á€ºá€¸á€›á€”á€º

                // á€€á€”á€¦á€¸ AI á€¡á€€á€¼á€¶á€‰á€¬á€á€ºá€€á€­á€¯ chat history á€á€½á€„á€º á€‘á€Šá€·á€ºá€á€½á€„á€ºá€¸á€›á€”á€º
                if (this.currentAiSuggestionForChat) {
                    UIUtil.addChatMessage(this.currentAiSuggestionForChat, 'ai');
                    this.chatHistory.push({ role: 'model', text: this.currentAiSuggestionForChat });
                }
                document.getElementById('chatInput').focus();
            }

            // Chat message á€•á€­á€¯á€·á€á€¼á€„á€ºá€¸
            async sendChatMessage() {
                const chatInput = document.getElementById('chatInput');
                const userMessage = chatInput.value.trim();

                if (!userMessage) return;

                UIUtil.addChatMessage(userMessage, 'user');
                this.chatHistory.push({ role: 'user', text: userMessage });
                chatInput.value = '';
                chatInput.style.height = 'auto'; // Reset textarea height

                // Loading spinner á€•á€¼á€á€›á€”á€º
                const sendBtn = document.getElementById('sendChatBtn');
                const originalBtnText = sendBtn.innerHTML;
                UIUtil.setLoading(sendBtn, true, 'á€•á€­á€¯á€·á€”á€±á€á€Šá€º...');

                try {
                    const aiResponse = await GeminiAPI.fetchChatResponse(
                        this.currentJournalTextForChat,
                        this.currentAiSuggestionForChat,
                        this.chatHistory, // á€œá€€á€ºá€›á€¾á€­ chat history á€€á€­á€¯ á€•á€±á€¸á€•á€­á€¯á€·á€›á€”á€º
                        userMessage,
                        this.apiKey
                    );
                    UIUtil.addChatMessage(aiResponse, 'ai');
                    this.chatHistory.push({ role: 'model', text: aiResponse });
                } catch (error) {
                    console.error('AI á€á€¯á€¶á€·á€•á€¼á€”á€ºá€™á€¾á€¯ á€›á€šá€°á€›á€¬á€á€½á€„á€º á€¡á€™á€¾á€¬á€¸á€¡á€šá€½á€„á€ºá€¸á€›á€¾á€­á€á€Šá€º:', error);
                    // Check if the error is due to model overload
                    if (error.message.includes("AI á€…á€”á€…á€º á€á€á€á€¬ á€¡á€œá€¯á€•á€ºá€™á€»á€¬á€¸á€”á€±á€•á€«á€á€Šá€ºá‹")) {
                        UIUtil.showToast(error.message); // Show the specific overloaded message
                    } else {
                        UIUtil.showToast('AI á€á€¯á€¶á€·á€•á€¼á€”á€ºá€™á€¾á€¯ á€›á€šá€°á€›á€¬á€á€½á€„á€º á€•á€¼á€¿á€”á€¬á€›á€¾á€­á€á€²á€·á€•á€«á€á€Šá€ºá‹');
                        UIUtil.addChatMessage("á€á€±á€¬á€„á€ºá€¸á€•á€”á€ºá€•á€«á€á€šá€ºáŠ á€¡á€á€¯á€á€»á€­á€”á€ºá€™á€¾á€¬ AI á€”á€²á€· á€á€»á€­á€á€ºá€†á€€á€ºá€œá€­á€¯á€·á€™á€›á€á€±á€¸á€•á€«á‹", 'ai');
                    }
                } finally {
                    UIUtil.setLoading(sendBtn, false, originalBtnText); // á€á€œá€¯á€á€ºá€€á€­á€¯ á€•á€¼á€”á€ºá€œá€Šá€ºá€á€á€ºá€™á€¾á€á€ºá€›á€”á€º
                }
            }
        }

        // DOM á€¡á€¬á€¸á€œá€¯á€¶á€¸ load á€•á€¼á€®á€¸á€•á€«á€€ app á€€á€­á€¯ á€…á€á€„á€ºá€›á€”á€º
        document.addEventListener('DOMContentLoaded', () => {
            new JournalApp();
        });
    </script>
</body>
</html>
